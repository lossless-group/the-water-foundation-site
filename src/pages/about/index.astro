---
// Immersive Story Flow Style
import BaseThemeLayout from '../../layouts/BaseThemeLayout.astro';
import WhyNowJumbo from '../../layouts/sections/core-messages/WhyNow--Jumbo.astro';
import AtCrisisPointJumbo from '../../layouts/sections/core-messages/AtCrisisPoint--Jumbo.astro';
import InvestInTransformationJumbo from '../../layouts/sections/core-messages/InvestInTransformation--Jumbo.astro';
import SolutionSurgeJumbo from '../../layouts/sections/core-messages/SolutionSurge--Jumbo.astro';
import OurMissionJumbo from '../../layouts/sections/core-messages/OurMission--Jumbo.astro';
import UnsiloedFinanceJumbo from '../../layouts/sections/core-messages/UnsiloedFinance--Jumbo.astro';
---

<BaseThemeLayout 
  title="Why Now?"
  description="An immersive journey through water innovation"
>
  <main class="overflow-x-hidden">
    
    <WhyNowJumbo />
    <AtCrisisPointJumbo />
    <InvestInTransformationJumbo />
    <SolutionSurgeJumbo />   
    <OurMissionJumbo />
    <UnsiloedFinanceJumbo />

    
  </main>
</BaseThemeLayout>

<style>
  @keyframes slide-up {
    from {
      opacity: 0;
      transform: translateY(100px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @keyframes expand {
    from {
      width: 0;
    }
    to {
      width: 8rem;
    }
  }
  
  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translateY(50px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .animate-slide-up {
    animation: slide-up 1s ease-out forwards;
  }
  
  .animate-slide-up-delay {
    animation: slide-up 1s ease-out 0.3s forwards;
    opacity: 0;
  }
  
  .animate-expand {
    animation: expand 1s ease-out 0.8s forwards;
    width: 0;
  }
  
  .animate-fade-in-up {
    animation: fade-in-up 1s ease-out 1.2s forwards;
    opacity: 0;
  }
  
  .parallax-text {
    transform: translateZ(0);
    transition: transform 0.3s ease-out;
  }
  
  .mission-card, .vertical-card {
    animation: fade-in-up 0.8s ease-out forwards;
    opacity: 0;
  }
  
  .mission-card:nth-child(1) { animation-delay: 0.2s; }
  .mission-card:nth-child(2) { animation-delay: 0.4s; }
  .mission-card:nth-child(3) { animation-delay: 0.6s; }
  
  .vertical-card:nth-child(1) { animation-delay: 0.1s; }
  .vertical-card:nth-child(2) { animation-delay: 0.3s; }
  .vertical-card:nth-child(3) { animation-delay: 0.5s; }
</style>

<script>
  // Parallax effect for text elements
  document.addEventListener('scroll', function() {
    const scrolled = window.pageYOffset;
    const parallaxElements = document.querySelectorAll('.parallax-text');
    
    parallaxElements.forEach(function(element) {
      if (element instanceof HTMLElement) {
        const rate = scrolled * -0.5;
        element.style.transform = 'translateY(' + rate + 'px)';
      }
    });
  });
  
  // Intersection Observer for animations
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };
  
  const observer = new IntersectionObserver(function(entries) {
    entries.forEach(function(entry) {
      if (entry.isIntersecting && entry.target instanceof HTMLElement) {
        entry.target.style.animationPlayState = 'running';
      }
    });
  }, observerOptions);
  
  document.querySelectorAll('.mission-card, .vertical-card').forEach(function(el) {
    observer.observe(el);
  });
</script>
