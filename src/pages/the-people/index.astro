---
// 1. Imports
import { Fragment } from 'astro/jsx-runtime';
import BaseThemeLayout from '@layouts/BaseThemeLayout.astro';
import PersonCard from '@components/team/PersonCard.astro';
import PersonCardSmall from '@components/team/PersonCardSmall.astro';
import WhoWeAreTimeline from '@layouts/sections/who-we-are/WhoWeAreTimeline.astro';
import ProposeYourself from '@layouts/sections/propose-yourself/ProposeYourself.astro';

// 2. Type Definitions
interface TeamMember {
  name: string;
  role: string;
  classifiers: string;
  image: string;
  bio: string;
  socialLinks: Array<{
    name: string;
    href: string;
    icon: string;
  }>;
}

interface TeamSection {
  title: string;
  classifier: string;
  useSmallCard: boolean;
}

// 3. Team Data
const teamSections: TeamSection[] = [
  { 
    title: "Managing Partners", 
    classifier: "Managing Partner",
    useSmallCard: false
  },
  { 
    title: "Founding Team", 
    classifier: "Founding Principal",
    useSmallCard: true
  },
  { 
    title: "Advisory Board", 
    classifier: "Founding Advisor",
    useSmallCard: true
  },
  { 
    title: "Vertical Partners", 
    classifier: "Vertical Partner",
    useSmallCard: true
  },
  { 
    title: "Philanthropy Team", 
    classifier: "Philanthropies",
    useSmallCard: true
  },
  { 
    title: "Visiting Fellows", 
    classifier: "Visiting Fellow",
    useSmallCard: true
  },
  { 
    title: "Trustees", 
    classifier: "Trustee",
    useSmallCard: false
  }
];


// Import team members from JSON file
import teamData from '../../content/people/team.json';

const teamMembers = teamData;


if (import.meta.env.DEV && teamMembers.length === 0) {
  console.warn('No team members found. The grid will be empty.');
}

// 5. Helper Functions
function groupByClassifier(members: TeamMember[], classifier: string): TeamMember[] {
  return members.filter(member => 
    member.classifiers && member.classifiers.includes(classifier)
  );
}
---


<BaseThemeLayout
  ogImage="/ogImageLandscape__The-Water-Foundation.jpg"
  ogImagePortrait="/ogImagePortrait__The-Water-Foundation.jpg"
  title="The People of The Water Foundation"
  description="Meet the passionate individuals working tirelessly to bring water resilience to 1 billion people."
>
  <main class="min-h-screen bg-gradient-to-b from-background to-background/50">
    <!-- Hero Section -->
    <section class="relative py-20 md:py-24 lg:py-32 bg-gradient-to-br from-slate-900 via-blue-900 to-teal-900 overflow-hidden">
      <!-- Animated Background Elements -->
      <div class="absolute inset-0">
        <!-- Gradient Orbs with Blur -->
        <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-gradient-to-br from-blue-600/20 to-transparent rounded-full blur-3xl animate-pulse-slow"></div>
        <div class="absolute bottom-1/4 right-1/4 w-80 h-80 bg-gradient-to-br from-teal-600/15 to-transparent rounded-full blur-3xl animate-pulse-delay"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-br from-cyan-600/10 to-transparent rounded-full blur-3xl animate-pulse-slow"></div>
      </div>

      <!-- Animated Grid Pattern -->
      <div class="absolute inset-0 opacity-5">
        <div class="w-full h-full" style="background-image: linear-gradient(rgba(59, 130, 246, 0.3) 1px, transparent 1px), linear-gradient(90deg, rgba(59, 130, 246, 0.3) 1px, transparent 1px); background-size: 50px 50px;"></div>
      </div>

      <!-- Floating Water Droplets -->
      <div class="absolute inset-0 pointer-events-none overflow-hidden opacity-30">
        <div class="absolute top-1/4 left-1/3 w-4 h-4 bg-gradient-to-br from-cyan-300 to-blue-400 rounded-full animate-float-bounce" style="animation-delay: 0s;"></div>
        <div class="absolute top-2/3 left-1/4 w-3 h-3 bg-gradient-to-br from-blue-300 to-teal-400 rounded-full animate-float-spin" style="animation-delay: 1s;"></div>
        <div class="absolute top-1/3 right-1/4 w-5 h-5 bg-gradient-to-br from-teal-300 to-cyan-400 rounded-full animate-float-drift" style="animation-delay: 2s;"></div>
        <div class="absolute bottom-1/3 right-1/3 w-2 h-2 bg-gradient-to-br from-blue-400 to-indigo-400 rounded-full animate-float-pulse" style="animation-delay: 0.5s;"></div>
        <div class="absolute top-1/2 left-1/5 w-3 h-3 bg-gradient-to-br from-indigo-300 to-purple-400 rounded-full animate-float-wave" style="animation-delay: 3s;"></div>
        <div class="absolute bottom-1/4 left-2/3 w-4 h-4 bg-gradient-to-br from-cyan-400 to-teal-500 rounded-full animate-float-bounce" style="animation-delay: 1.5s;"></div>
        <div class="absolute top-3/4 right-1/5 w-2 h-2 bg-gradient-to-br from-blue-500 to-cyan-400 rounded-full animate-float-spin" style="animation-delay: 2.5s;"></div>
      </div>

      <!-- Animated Circle Effects -->
      <div class="absolute inset-0 pointer-events-none overflow-hidden opacity-10">
        <div class="absolute top-1/3 left-1/2 w-32 h-32 border border-cyan-400 rounded-full animate-circle-gentle" style="animation-delay: 0s;"></div>
        <div class="absolute bottom-1/3 right-1/3 w-24 h-24 border border-blue-400 rounded-full animate-circle-slow" style="animation-delay: 2s;"></div>
        <div class="absolute top-2/3 left-1/4 w-40 h-40 border border-teal-400 rounded-full animate-circle-drift" style="animation-delay: 1s;"></div>
      </div>

      <!-- Floating Particles -->
      <div class="absolute inset-0 pointer-events-none overflow-hidden opacity-15">
        <div class="absolute top-1/5 left-1/6 w-1 h-1 bg-white rounded-full animate-particle-float" style="animation-delay: 0s;"></div>
        <div class="absolute top-3/5 left-3/4 w-1 h-1 bg-cyan-200 rounded-full animate-particle-float" style="animation-delay: 1s;"></div>
        <div class="absolute bottom-1/5 right-1/6 w-1 h-1 bg-blue-200 rounded-full animate-particle-float" style="animation-delay: 2s;"></div>
        <div class="absolute top-2/5 right-2/3 w-1 h-1 bg-teal-200 rounded-full animate-particle-float" style="animation-delay: 3s;"></div>
        <div class="absolute bottom-2/5 left-1/2 w-1 h-1 bg-indigo-200 rounded-full animate-particle-float" style="animation-delay: 1.5s;"></div>
      </div>

      <!-- Content -->
      <div class="relative z-10 max-w-6xl mx-auto px-6 text-center">
        <!-- Header -->
        <div class="mb-16">
          <h1 class="text-4xl md:text-5xl lg:text-6xl font-light text-white mb-8 tracking-wide animate-fade-in-up">
            Our <span class="text-cyan-300 font-normal">People</span>
          </h1>
          <p class="text-xl md:text-2xl text-white/90 max-w-4xl mx-auto leading-relaxed font-light animate-fade-in-up-delay">
            Meet the passionate individuals dedicated to securing water independence for 1 billion+ people by 2035.
          </p>
        </div>
      </div>
    </section>

    <!-- Masonry Grid Layout -->
    <section class="py-12">
      <div class="container mx-auto px-4">
        <div class="masonry-grid">
          {!teamMembers || teamMembers.length === 0 ? (
            <div class="masonry-item w-full text-center py-8">
              <p class="text-gray-500">No team members found.</p>
            </div>
          ) : teamSections.flatMap((section) => {
            
            const sectionMembers = groupByClassifier(teamMembers, section.classifier);
            if (sectionMembers.length === 0) return [];
            
            return [
              // Section header
              <h2 class="masonry-header">
                {section.title}
              </h2>,
              // Team members
              ...sectionMembers.map((member) => (
                <div class="masonry-item">
                  <PersonCard {...member} />
                </div>
              ))
            ];
          })}
        </div>
      </div>
    </section>

    <style>
      /* Ensure images maintain aspect ratio */
      .masonry-item img {
        width: 100%;
        height: auto;
        border-radius: 0.5rem;
        transition: transform 0.3s ease;
      }

      /* Card hover effects */
      .masonry-item > div {
        transition: all 0.3s ease;
        height: 100%;
        background: var(--card-bg, #fff);
        border-radius: 0.75rem;
        overflow: hidden;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }

      .masonry-item:hover > div {
        transform: translateY(-4px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }

      /* Grid container */
      .masonry-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
        width: 100%;
        max-width: 1440px;
        margin: 0 auto;
        padding: 0 2rem;
      }
      
      /* Grid items */
      .masonry-item {
        width: 100%;
        transition: transform 0.2s ease-in-out;
      }
      
      /* Card container */
      .masonry-item > article {
        display: flex;
        flex-direction: column;
        height: 100%;
      }
      
      /* Ensure images stay contained */
      .masonry-item img {
        width: 100%;
        height: auto;
        object-fit: cover;
      }
      
      /* Section headers */
      .masonry-header {
        grid-column: 1 / -1;
        margin: 3rem 0 1rem;
        color: var(--color-foreground);
        font-size: 1.75rem;
        font-weight: 300;
        padding-bottom: 0.5rem;
        position: relative;
      }
      
      .masonry-header:first-child {
        margin-top: 0;
      }
      
      .masonry-header:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 3rem;
        height: 2px;
        background: linear-gradient(90deg, var(--color-primary), transparent);
      }
      
      /* Responsive columns */
      @media (min-width: 640px) {
        .masonry-grid {
          grid-template-columns: repeat(2, minmax(300px, 1fr));
        }
      }
      
      @media (min-width: 1024px) {
        .masonry-grid {
          grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        }
        
        .masonry-header {
          font-size: 2rem;
        }
      }
    </style>

    <WhoWeAreTimeline />
    <ProposeYourself />
  </main>
</BaseThemeLayout>

<style>
  /* Water theme specific styles */
  :global(html[data-theme="water"]) {
    --color-primary: 14 116 144;  /* Cyan-700 */
    --color-primary-foreground: 255 255 255;
    --color-background: 240 249 255;  /* Light blue-50 */
    --color-foreground: 3 7 18;  /* Gray-950 */
    --color-border: 224 242 254;  /* Light blue-100 */
  }
  
  /* Dark mode overrides */
  :global(html[data-theme="water"].dark) {
    --color-primary: 8 145 178;  /* Cyan-600 */
    --color-background: 8 47 73;  /* Dark blue-950 */
    --color-foreground: 248 250 252;  /* Slate-50 */
    --color-border: 30 58 138;  /* Blue-900 */
  }

  /* Smooth scrolling for section headers */
  h2 {
    scroll-margin-top: 2rem;
  }

  /* Hero Animation Styles */
  @keyframes float {
    0%, 100% {
      transform: translateY(0px) translateX(0px);
    }
    25% {
      transform: translateY(-10px) translateX(5px);
    }
    50% {
      transform: translateY(-5px) translateX(-5px);
    }
    75% {
      transform: translateY(-15px) translateX(3px);
    }
  }

  @keyframes float-bounce {
    0%, 100% {
      transform: translateY(0px) scale(1);
    }
    25% {
      transform: translateY(-15px) scale(1.1);
    }
    50% {
      transform: translateY(-8px) scale(0.95);
    }
    75% {
      transform: translateY(-20px) scale(1.05);
    }
  }

  @keyframes float-spin {
    0% {
      transform: translateY(0px) rotate(0deg);
    }
    25% {
      transform: translateY(-10px) rotate(90deg);
    }
    50% {
      transform: translateY(-5px) rotate(180deg);
    }
    75% {
      transform: translateY(-15px) rotate(270deg);
    }
    100% {
      transform: translateY(0px) rotate(360deg);
    }
  }

  @keyframes float-drift {
    0%, 100% {
      transform: translateY(0px) translateX(0px);
    }
    33% {
      transform: translateY(-12px) translateX(15px);
    }
    66% {
      transform: translateY(-8px) translateX(-10px);
    }
  }

  @keyframes float-pulse {
    0%, 100% {
      transform: translateY(0px) scale(1);
      opacity: 0.7;
    }
    50% {
      transform: translateY(-10px) scale(1.3);
      opacity: 1;
    }
  }

  @keyframes float-wave {
    0%, 100% {
      transform: translateY(0px) skew(0deg);
    }
    25% {
      transform: translateY(-8px) skew(5deg);
    }
    50% {
      transform: translateY(-15px) skew(0deg);
    }
    75% {
      transform: translateY(-8px) skew(-5deg);
    }
  }

  @keyframes circle-gentle {
    0%, 100% {
      transform: scale(1) rotate(0deg);
      opacity: 0.6;
    }
    50% {
      transform: scale(1.1) rotate(180deg);
      opacity: 0.8;
    }
  }

  @keyframes circle-slow {
    0%, 100% {
      transform: scale(0.9) translateX(0px);
      opacity: 0.5;
    }
    50% {
      transform: scale(1.2) translateX(10px);
      opacity: 0.7;
    }
  }

  @keyframes circle-drift {
    0%, 100% {
      transform: scale(1) translateY(0px);
      opacity: 0.4;
    }
    33% {
      transform: scale(0.8) translateY(-15px);
      opacity: 0.6;
    }
    66% {
      transform: scale(1.1) translateY(5px);
      opacity: 0.5;
    }
  }

  @keyframes particle-float {
    0%, 100% {
      transform: translateY(0px) translateX(0px);
      opacity: 0.3;
    }
    25% {
      transform: translateY(-30px) translateX(10px);
      opacity: 1;
    }
    50% {
      transform: translateY(-60px) translateX(-5px);
      opacity: 0.8;
    }
    75% {
      transform: translateY(-40px) translateX(15px);
      opacity: 0.6;
    }
  }

  @keyframes fade-in-up {
    0% {
      opacity: 0;
      transform: translateY(30px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes glow {
    0%, 100% {
      text-shadow: 0 0 5px rgba(103, 232, 249, 0.5);
    }
    50% {
      text-shadow: 0 0 20px rgba(103, 232, 249, 0.8), 0 0 30px rgba(103, 232, 249, 0.6);
    }
  }

  @keyframes expand {
    0% {
      width: 0;
      opacity: 0;
    }
    100% {
      width: 8rem;
      opacity: 1;
    }
  }

  @keyframes pulse-slow {
    0%, 100% {
      opacity: 0.4;
      transform: scale(1);
    }
    50% {
      opacity: 0.8;
      transform: scale(1.05);
    }
  }
  
  @keyframes pulse-delay {
    0%, 100% {
      opacity: 0.3;
      transform: scale(0.95);
    }
    50% {
      opacity: 0.7;
      transform: scale(1.1);
    }
  }
  
  /* Animation Classes */
  .animate-float {
    animation: float 6s ease-in-out infinite;
  }

  .animate-float-bounce {
    animation: float-bounce 7s ease-in-out infinite;
  }

  .animate-float-spin {
    animation: float-spin 8s linear infinite;
  }

  .animate-float-drift {
    animation: float-drift 9s ease-in-out infinite;
  }

  .animate-float-pulse {
    animation: float-pulse 5s ease-in-out infinite;
  }

  .animate-float-wave {
    animation: float-wave 6s ease-in-out infinite;
  }

  .animate-circle-gentle {
    animation: circle-gentle 8s ease-in-out infinite;
  }

  .animate-circle-slow {
    animation: circle-slow 10s ease-in-out infinite;
  }

  .animate-circle-drift {
    animation: circle-drift 12s ease-in-out infinite;
  }

  .animate-particle-float {
    animation: particle-float 12s ease-in-out infinite;
  }

  .animate-fade-in-up {
    animation: fade-in-up 1s ease-out forwards;
  }

  .animate-fade-in-up-delay {
    animation: fade-in-up 1s ease-out 0.5s forwards;
    opacity: 0;
  }

  .animate-glow {
    animation: glow 3s ease-in-out infinite;
  }

  .animate-expand {
    animation: expand 1.5s ease-out 1s forwards;
    width: 0;
  }
  
  .animate-pulse-slow {
    animation: pulse-slow 4s ease-in-out infinite;
  }
  
  .animate-pulse-delay {
    animation: pulse-delay 5s ease-in-out infinite 1s;
  }
</style>